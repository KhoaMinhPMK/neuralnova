<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Payment Successful | NeuralNova</title>
  <link rel="icon" type="image/x-icon" href="../../assets/images/logo.ico" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest" defer></script>
  <style>
    :root{--bg:#0f0a1f;--panel:rgba(15,15,20,.72);--border:rgba(255,255,255,.08);--text:#e6e6f0;--muted:#a3a3b2;--primary:#7c3aed;--cyan:#22d3ee;--ok:#10b981}
    *{box-sizing:border-box}html,body{height:100%}body{margin:0;color:var(--text);background:radial-gradient(1000px 700px at 10% -10%,rgba(124,58,237,.35),transparent),radial-gradient(900px 600px at 110% 0,rgba(34,211,238,.25),transparent),var(--bg) url('../../assets/images/bg.jpg') center/cover fixed no-repeat;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    .wrap{min-height:100%;display:grid;place-items:center;padding:24px}
    .card{width:min(800px,94vw);background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:32px;backdrop-filter:blur(20px)}
    
    /* Success Header */
    .success-header{text-align:center;margin-bottom:32px}
    .success-icon{width:64px;height:64px;margin:0 auto 16px;border-radius:50%;display:grid;place-items:center;background:linear-gradient(135deg,rgba(16,185,129,.2),rgba(16,185,129,.05));border:2px solid rgba(16,185,129,.4);animation:scaleIn .4s ease}
    @keyframes scaleIn{from{transform:scale(0)}to{transform:scale(1)}}
    .success-icon svg{width:32px;height:32px;color:var(--ok)}
    h1{margin:0 0 8px;font-size:28px;letter-spacing:.3px}
    .sub{color:var(--muted);margin:0;font-size:15px}
    
    /* Invoice */
    .invoice{background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:14px;padding:24px;margin:24px 0}
    .invoice-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid var(--border)}
    .company-info h2{margin:0 0 4px;font-size:20px}
    .company-info p{margin:2px 0;font-size:13px;color:var(--muted)}
    .invoice-meta{text-align:right}
    .invoice-meta .inv-num{font-size:14px;color:var(--muted);margin-bottom:4px}
    .invoice-meta .inv-id{font-size:18px;font-weight:700;color:var(--cyan)}
    .invoice-meta .inv-date{font-size:12px;color:var(--muted);margin-top:4px}
    
    /* Invoice Details */
    .invoice-details{margin:20px 0}
    .detail-row{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:12px}
    .detail-box h3{margin:0 0 6px;font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:.5px}
    .detail-box p{margin:0;font-size:15px;font-weight:600}
    
    /* Invoice Items */
    .invoice-items{margin:24px 0}
    .item-header{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:12px;padding:12px;background:rgba(255,255,255,.03);border-radius:8px;margin-bottom:8px}
    .item-header span{font-size:12px;color:var(--muted);font-weight:600;text-transform:uppercase}
    .item-row{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:12px;padding:12px;border-bottom:1px dashed var(--border)}
    .item-row:last-child{border-bottom:none}
    
    /* Invoice Total */
    .invoice-total{margin-top:16px;padding-top:16px;border-top:2px solid var(--border)}
    .total-row{display:flex;justify-content:space-between;padding:8px 12px;font-size:14px}
    .total-row.grand{font-size:20px;font-weight:700;margin-top:8px;padding-top:12px;border-top:1px solid var(--border)}
    .total-row.grand .label{color:var(--muted)}
    .total-row.grand .value{color:var(--cyan)}
    
    /* Actions */
    .actions{display:flex;gap:12px;flex-wrap:wrap;margin-top:24px}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:12px 20px;border-radius:12px;border:1px solid transparent;text-decoration:none;color:#fff;font-weight:700;background:rgba(255,255,255,.06);border:1px solid var(--border);transition:all .2s}
    .btn:hover{background:rgba(255,255,255,.12);transform:translateY(-1px)}
    .btn.primary{border-color:transparent;background:linear-gradient(135deg,var(--primary),#6d28d9 45%,var(--cyan));box-shadow:0 10px 30px rgba(124,58,237,.25)}
    .btn.primary:hover{filter:brightness(1.1);box-shadow:0 12px 35px rgba(124,58,237,.35)}
    .btn svg{width:18px;height:18px}
    
    /* Footer Info */
    .footer-info{margin-top:24px;padding-top:24px;border-top:1px solid var(--border);text-align:center}
    .info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-top:16px}
    .info-item{display:flex;align-items:center;gap:10px;padding:12px;background:rgba(124,58,237,.05);border:1px solid rgba(124,58,237,.2);border-radius:10px}
    .info-item svg{width:20px;height:20px;color:var(--cyan);flex-shrink:0}
    .info-item div{text-align:left}
    .info-item strong{display:block;font-size:13px;color:#fff;margin-bottom:2px}
    .info-item p{margin:0;font-size:12px;color:var(--muted)}
    
    @media (max-width: 760px){
      .card{padding:20px}
      .invoice{padding:16px}
      .invoice-header{flex-direction:column;gap:16px}
      .invoice-meta{text-align:left}
      .detail-row{grid-template-columns:1fr}
      .item-header,.item-row{grid-template-columns:1.5fr 1fr 1fr;gap:8px;font-size:13px}
      .item-header span:last-child,.item-row span:last-child{display:none}
      .info-grid{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <!-- Success Header -->
      <div class="success-header">
        <div class="success-icon" aria-hidden="true">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path>
          </svg>
        </div>
        <h1>Payment Successful!</h1>
        <p class="sub">Thank you for choosing NeuralNova</p>
      </div>

      <!-- Invoice -->
      <div class="invoice" id="invoiceToPrint">
        <div class="invoice-header">
          <div class="company-info">
            <h2>NeuralNova JSC</h2>
            <p>Email: billing@neuralnova.space</p>
            <p>Hotline: +84 (0) 123 456 789</p>
            <p>Website: https://neuralnova.space</p>
          </div>
          <div class="invoice-meta">
            <div class="inv-num">INVOICE</div>
            <div class="inv-id" id="invoiceId">INV-000000</div>
            <div class="inv-date" id="invoiceDate">—</div>
          </div>
        </div>

        <div class="invoice-details">
          <div class="detail-row">
            <div class="detail-box">
              <h3>Customer</h3>
              <p id="customerName">—</p>
            </div>
            <div class="detail-box">
              <h3>Email</h3>
              <p id="customerEmail">—</p>
            </div>
          </div>
          <div class="detail-row">
            <div class="detail-box">
              <h3>Payment Method</h3>
              <p id="paymentMethod">—</p>
            </div>
            <div class="detail-box">
              <h3>Transaction ID</h3>
              <p id="transactionId">—</p>
            </div>
          </div>
        </div>

        <div class="invoice-items">
          <div class="item-header">
            <span>Description</span>
            <span style="text-align:center">Quantity</span>
            <span style="text-align:right">Unit Price</span>
            <span style="text-align:right">Amount</span>
          </div>
          <div class="item-row">
            <span id="itemDescription">NeuralNova Service Plan</span>
            <span style="text-align:center" id="itemQty">1</span>
            <span style="text-align:right" id="itemPrice">$0</span>
            <span style="text-align:right" id="itemSubtotal">$0</span>
          </div>
        </div>

        <div class="invoice-total">
          <div class="total-row">
            <span class="label">Subtotal</span>
            <span class="value" id="subtotal">$0</span>
          </div>
          <div class="total-row">
            <span class="label">Discount</span>
            <span class="value" id="discount">- $0</span>
          </div>
          <div class="total-row grand">
            <span class="label">GRAND TOTAL</span>
            <span class="value" id="grandTotal">$0</span>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button class="btn primary" onclick="window.print()">
          <i data-lucide="printer"></i>
          <span>Print Invoice</span>
        </button>
        <a class="btn" href="../../index.html">
          <i data-lucide="home"></i>
          <span>Home</span>
        </a>
        <a class="btn" href="../profile/index.html">
          <i data-lucide="user"></i>
          <span>My Account</span>
        </a>
      </div>

      <!-- Footer Info -->
      <div class="footer-info">
        <p class="sub">✉️ Electronic invoice has been sent to your email</p>
        <div class="info-grid">
          <div class="info-item">
            <i data-lucide="mail"></i>
            <div>
              <strong>Email Support</strong>
              <p>support@neuralnova.space</p>
            </div>
          </div>
          <div class="info-item">
            <i data-lucide="headphones"></i>
            <div>
              <strong>24/7 Hotline</strong>
              <p>+84 (0) 123 456 789</p>
            </div>
          </div>
          <div class="info-item">
            <i data-lucide="book-open"></i>
            <div>
              <strong>Documentation</strong>
              <p>docs.neuralnova.space</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    const p = new URLSearchParams(location.search);
    const itemName = p.get('name') || 'Gói NeuralNova Premium';
    const method = p.get('method') || 'CARD';
    const last4 = p.get('last4');
    const total = Number(p.get('total') || 0);
    const discount = Number(p.get('discount') || 0);
    const subtotal = total + discount;
    
    const fmt = (n) => new Intl.NumberFormat('vi-VN', {style:'currency', currency:'VND'}).format(n);
    const now = new Date();
    const invoiceNum = 'INV-' + now.getFullYear() + ('0' + (now.getMonth()+1)).slice(-2) + ('0' + now.getDate()).slice(-2) + '-' + String(now.getTime()).slice(-6);
    const txId = 'TXN-' + now.getTime();
    
    // Populate invoice
    document.getElementById('invoiceId').textContent = invoiceNum;
    document.getElementById('invoiceDate').textContent = now.toLocaleDateString('vi-VN', {day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit'});
    document.getElementById('transactionId').textContent = txId;
    
    // Customer (from localStorage or defaults)
    const customerName = localStorage.getItem('nn_user_name') || 'Khách hàng';
    const customerEmail = localStorage.getItem('nn_user_email') || 'customer@example.com';
    document.getElementById('customerName').textContent = customerName;
    document.getElementById('customerEmail').textContent = customerEmail;
    
    // Payment method
    let methodText = '—';
    if (method === 'CARD') methodText = `Thẻ tín dụng/ghi nợ (**** ${last4||'••••'})`;
    else if (method === 'BANK') methodText = 'Chuyển khoản ngân hàng';
    else if (method === 'WALLET') methodText = 'Ví NeuralNova';
    document.getElementById('paymentMethod').textContent = methodText;
    
    // Item details
    document.getElementById('itemDescription').textContent = itemName;
    document.getElementById('itemQty').textContent = '1';
    document.getElementById('itemPrice').textContent = fmt(subtotal);
    document.getElementById('itemSubtotal').textContent = fmt(subtotal);
    
    // Totals
    document.getElementById('subtotal').textContent = fmt(subtotal);
    document.getElementById('discount').textContent = discount > 0 ? '- ' + fmt(discount) : '0₫';
    document.getElementById('grandTotal').textContent = fmt(total);
    
    // Init Lucide icons
    document.addEventListener('DOMContentLoaded', () => {
      if (window.lucide && lucide.createIcons) lucide.createIcons();
    });
  </script>
</body>
</html>
